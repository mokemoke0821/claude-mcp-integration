name: Simple AI Bot

on:
  issue_comment:
    types: [created]
  issues:
    types: [opened]

permissions:
  issues: write
  pull-requests: write

jobs:
  respond-to-mention:
    if: contains(github.event.comment.body || github.event.issue.body, '@claude')
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Analyze and Respond
      uses: actions/github-script@v7
      with:
        script: |
          const issueNumber = context.issue.number;
          const body = context.payload.comment?.body || context.payload.issue?.body || '';
          
          // @claudeãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã‚’è§£æ
          const query = body.toLowerCase();
          let response = '';
          
          // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®å¿œç­”
          if (query.includes('åˆ†æ') || query.includes('analyze')) {
            response = `## ğŸ“Š ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ†æ
          
### ãƒªãƒã‚¸ãƒˆãƒªæ¦‚è¦
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: Claude MCP Server Integration
- **ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 174
- **ã‚³ãƒ¼ãƒ‰è¡Œæ•°**: 51,135
- **çµ±åˆæ¸ˆã¿MCPã‚µãƒ¼ãƒãƒ¼**: 3

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
1. **filesystem** - ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ“ä½œ
2. **enhanced-development-commander** - é–‹ç™ºæ”¯æ´ãƒ„ãƒ¼ãƒ«
3. **enhanced-file-commander** - ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãƒ„ãƒ¼ãƒ«

### GitHub Actions
- âœ… CI/CDè‡ªå‹•åŒ–è¨­å®šæ¸ˆã¿
- âœ… è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­
- âœ… AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆæ©Ÿèƒ½å®Ÿè£…æ¸ˆã¿`;
          } 
          else if (query.includes('ä½¿ã„æ–¹') || query.includes('help')) {
            response = `## ğŸ“š ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
\`\`\`bash
# 1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/${context.repo.owner}/${context.repo.repo}.git

# 2. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# 3. MCPè¨­å®šé©ç”¨
npm run setup
\`\`\`

### @claudeãƒ¡ãƒ³ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
- \`@claude åˆ†æ\` - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ†æ
- \`@claude ä½¿ã„æ–¹\` - ã“ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
- \`@claude ãƒ†ã‚¹ãƒˆ\` - ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒçŠ¶æ³
- \`@claude çŠ¶æ…‹\` - ç¾åœ¨ã®ãƒ“ãƒ«ãƒ‰çŠ¶æ…‹`;
          }
          else if (query.includes('ãƒ†ã‚¹ãƒˆ') || query.includes('test')) {
            response = `## ğŸ§ª ãƒ†ã‚¹ãƒˆçŠ¶æ³

### æœ€æ–°ã®ãƒ†ã‚¹ãƒˆçµæœ
- âœ… å¿…é ˆãƒ†ã‚¹ãƒˆ: 4/4 æˆåŠŸ
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ã‚¹ãƒˆ: 4/4 æˆåŠŸ
- âœ… GitHub Actions: æ­£å¸¸å‹•ä½œä¸­

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ–¹æ³•
\`\`\`bash
npm run test:integration
\`\`\``;
          }
          else if (query.includes('çŠ¶æ…‹') || query.includes('status')) {
            response = `## ğŸš¦ ç¾åœ¨ã®çŠ¶æ…‹

### ãƒ“ãƒ«ãƒ‰çŠ¶æ…‹
- ğŸŸ¢ main ãƒ–ãƒ©ãƒ³ãƒ: ãƒ“ãƒ«ãƒ‰æˆåŠŸ
- ğŸŸ¢ GitHub Actions: å‹•ä½œä¸­
- ğŸŸ¢ MCP Servers: å…¨ã¦æ­£å¸¸

### çµ±åˆçŠ¶æ³
- GitHub Actions CI/CD: âœ… å®Œäº†
- MCP Serverçµ±åˆ: âœ… å®Œäº†
- AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ: âœ… å‹•ä½œä¸­`;
          }
          else {
            response = `## ğŸ¤– AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ

ã”è³ªå•ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ãŠè©¦ã—ãã ã•ã„ï¼š

- \`@claude åˆ†æ\` - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è©³ç´°åˆ†æ
- \`@claude ä½¿ã„æ–¹\` - ä½¿ç”¨æ–¹æ³•ã‚¬ã‚¤ãƒ‰
- \`@claude ãƒ†ã‚¹ãƒˆ\` - ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒçŠ¶æ³
- \`@claude çŠ¶æ…‹\` - ç¾åœ¨ã®ãƒ“ãƒ«ãƒ‰çŠ¶æ…‹

è©³ç´°ãªã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ãªå ´åˆã¯ã€[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://github.com/${context.repo.owner}/${context.repo.repo}/blob/main/README.md)ã‚’ã”ç¢ºèªãã ã•ã„ã€‚`;
          }
          
          // ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿
          await github.rest.issues.createComment({
            owner: context.repo.owner,
            repo: context.repo.repo,
            issue_number: issueNumber,
            body: response + '\n\n---\n*ğŸ¤– ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯è‡ªå‹•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã¾ã—ãŸ*'
          });
          
          console.log('Response posted successfully!'); 